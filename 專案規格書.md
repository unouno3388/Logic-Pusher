# Logic Pusher 專案規格書 (Project Specification)

## 1. 專案概述 (Project Overview)
* **專案名稱**：Logic Pusher
* **遊戲類型**：益智解謎 (Logic Puzzle)
* **核心機制**：將「推箱子」的位移玩法與「數位邏輯電路」結合。玩家需在網格中排列邏輯方塊，完成從訊號源到終點的電路導通。
* **目標受眾**：對邏輯解謎感興趣、想透過遊戲化學習基礎數位電路概念的玩家。

---

## 2. 遊戲機制設計 (Game Mechanics)
### 2.1 核心操作
* **角色位移**：玩家可操作角色在 2D 網格中進行上下左右移動。
* **推動邏輯**：玩家可推動前方的一個方塊，若方塊後方有障礙物或其他方塊則無法推動。
* **勝利條件**：終點方塊（Target）接收到高電位（True/1）訊號。

### 2.2 邏輯元件規格
| 元件名稱 | 代號 | 邏輯行為描述 | 朝向影響 |
| :--- | :---: | :--- | :--- |
| **訊號源 (Source)** | S | 恆定輸出高電位 (1)。 | 決定輸出接口位置 |
| **及閘 (AndGate)** | A | 兩個輸入皆為 1 時，輸出 1。 | 決定輸入與輸出位置 |
| **或閘 (OrGate)** | O | 任一輸入為 1 時，輸出 1。 | 決定輸入與輸出位置 |
| **反閘 (NotGate)** | N | 將輸入訊號反轉 (0->1, 1->0)。 | 決定輸入與輸出位置 |
| **導線 (Wire)** | W | 全向連接，僅負責傳遞訊號。 | 無 |
| **終點 (Target)** | T | 接收高電位訊號以觸發過關。 | 決定輸入接口位置 |

---

## 3. 系統架構 (System Architecture)
本專案基於 **Manager-Based** 與 **Decoupling (解耦)** 原則設計，主要分為三個核心層級：

### 3.1 邏輯核心層 (Logic.Core)
* **GridSystem**：管理網格數據，處理物理碰撞偵測與方塊推動的合法性檢查。
* **CircuitSystem**：電路模擬引擎。使用深度優先搜索 (DFS) 計算訊號流向，具備防死循環機制。
* **IBlockEntity**：統一的方塊介面，規範所有邏輯方塊的行為。

### 3.2 表現與控制層 (Unity Layer)
* **GameManager**：控制遊戲主流程（載入、遊戲狀態切換、勝利判斷）。
* **LevelLoader**：負責解析關卡 JSON/SO 並動態生成地圖實體。
* **BlockController**：將核心邏輯層的狀態同步至 Unity 視覺物件，並驅動平滑動畫。

### 3.3 UI 系統 (UI System)
* **UIManager**：核心介面管理器，負責面版（Panel）的資源加載、開啟/關閉堆疊與層級控管。
* **BasePanel**：定義面板生命週期（`Open`, `Close`, `UpdatePanel`），支援 UniTask 動畫同步。
* **具體實作面板**：
    * `MainMenuPanel`：遊戲主入口。
    * `SelectLevelPanel`：動態讀取 `LevelDatabaseSO` 生成關卡選擇按鈕。
    * `GamePanel`：顯示當前關卡資訊，提供「重置」與「設置」功能。
    * `WinLevelPanel`：勝利結算與前往下一關。
    * `SettingPanel`：音量與系統參數設置。

---

## 4. 關鍵技術實作 (Key Technical Details)

### 4.1 事件驅動與解耦
* **OnBlockMoved**：當玩家完成一次推動，觸發此事件通知 `CircuitSystem` 重新評估全圖電力。
* **UI 與 邏輯分離**：UI 僅透過 `GameManager` 的公開方法傳遞請求，不直接持有或修改底層地圖數據。

### 4.2 視覺與動畫
* 使用 **DOTween** 處理方塊推動的平滑過渡（Linear Tween）與 UI 面板的縮放/淡入淡出。

---

## 5. 開發環境與依賴 (Environment & Dependencies)
* **Unity Editor**：2022.3 LTS
* **Render Pipeline**：Universal Render Pipeline (URP)
* **核心插件**：
    * **UniTask**：異步編程框架。
    * **DOTween**：動畫引擎。
    * **TextMeshPro**：文字渲染系統。
    * **Input System**：現代化輸入處理。

---

## 6. 資源路徑規範
* **關卡數據**：`Assets/Resources/Levels/` (JSON & SO)
* **UI 面板**：`Assets/Resources/Prefabs/UI/`
* **腳本目錄**：
    * 核心邏輯：`Assets/_Project/Scripts/Core/`

    * UI 實作：`Assets/Script/UI/`
